<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-dark-5@1.1.3/dist/css/bootstrap-nightfall.min.css" media="(prefers-color-scheme: dark)">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/styles/base16/ashes.min.css">
    <link rel="stylesheet" href="../../style.css" type="text/css">
    <title>線形回帰</title>
    <meta NAME="robots" CONTENT="noindex,nofollow">
  </head>
  <body>
    
    <nav class="navbar sticky-top bg-body" style="--bs-breadcrumb-divider: '>';" aria-label="breadcrumb">
      <div class="container" style="max-width: 40em;">
        <ol class="breadcrumb">
          
            <li class="breadcrumb-item"><a href="../../index.html">margraph</a></li>
          
            <li class="breadcrumb-item"><a href="../../math/index.html">math</a></li>
          
            <li class="breadcrumb-item"><a href="../../math/probability-statistics/index.html">probability-statistics</a></li>
          
          <li class="breadcrumb-item">線形回帰</li>
        </ol>
      </div>
    </nav>

    <article class="container" style="max-width: 40em;">

      <h1>線形回帰</h1>

      
        <div class="contents">
        
            
              <div><ul>
  <li>授業で扱った、<a href="../../math/probability-statistics/09-least-squares-method.html">最小二乗法</a>を用いた線形<a href="../../math/probability-statistics/08-regression.html">回帰</a>について</li>
  <li>$a$ を変形していくと、$\dfrac{C_{XY}}{S_X^2}$ となる
    <ul>
      <li>$C_{XY}$ は測定値 $x_i$ と $y_i$ の共<a href="../../math/probability-statistics/05a-variance.html">分散</a></li>
      <li>$S_X$ は測定値 $x_i$ の<a href="../../math/probability-statistics/05a-variance.html">分散</a></li>
    </ul>
  </li>
</ul>
</div>
            
          
            
              <h2>計算方法</h2>
            
          
            
              <div><ul>
  <li>$\displaystyle L = \sum_{i=1}^N (\bar y_i - y_i)^2 = \sum_{i=1}^N (a x_i + b - y_i)^2$ が最小になるように $a$ と $b$ を求める</li>
  <li>2次関数であれば、微分が0になる場所が最大値/最小値になる</li>
  <li>$\displaystyle L = \sum (a^2 x_i^2 + b^2 + y_i^2 + 2 a b x_i - 2 b y_i - 2 a x_i y_i)$</li>
  <li>$\displaystyle L = a^2 \sum x_i^2 + N b^2 + \sum y_i^2 + 2ab \sum x_i - 2b \sum y_i - 2a \sum x_i y_i$</li>
  <li>ところで、$\sum x_i^2, \sum y_i^2$ は観測結果から分かるので、これは $a$ と $b$ の2次関数となる
    <ul>
      <li>TODO : 2変数の2次関数わからん</li>
    </ul>
  </li>
  <li>最小値を求めるためにbで微分すると、
    <ul>
      <li>$\displaystyle \dfrac{\partial L}{\partial b} = 2Nb + 2a \sum x_i - 2 \sum y_i = 0$</li>
      <li>$b = \dfrac{\sum y_i - a \sum x_i}{N}$</li>
      <li>$b = \bar y_i - a \bar x_i$</li>
    </ul>
  </li>
  <li>aも求める必要があるので、そちらも微分して
    <ul>
      <li>$\displaystyle  \dfrac{\partial L}{\partial a} = 2a \sum x_i^2 + 2b \sum x_i - 2b \sum x_i y_i = 0$</li>
      <li>ここでbを入れたりと、少しギャップがある</li>
      <li>$a = \dfrac{\displaystyle \sum x_i y_i - N \bar x_i \bar y_i}{\displaystyle \sum x_i^2 - N \bar x_i^2}$
        <ul>
          <li>$\sum x_i = N \bar x$ と見る</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</div>
            
          
        </div>
      

      

      
      
      
      <hr />

      
        <div class="hood-link">
          <div class="row text-center">
            <div class="col">
              
                前の記事<br />
                <a href="../../math/probability-statistics/09-least-squares-method.html">最小二乗法</a>
              
            </div>
            <div class="col">
              
                目次<br />
                <a href="../../math/probability-statistics/index.html">probability-statistics</a>
              
            </div>
            <div class="col">
              
                次の記事<br />
                <a href="../../math/probability-statistics/11-probability.html">確率</a>
              
            </div>
          </div>
        </div>
      

      <div class="d-flex flex-row-reverse">
        
          <button type="button" class="btn btn-outline-primary btn-sm" onclick="window.location.href='https://github.com/soukouki/margraph/edit/master/src/math/probability-statistics/10-linier-regression.md';">Edit</button>
        
        
      </div>

      
      <div class="link-network">
        
          <div class="row flex-nowrap overflow-auto">
            <div class="col-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title fs-6"><a href="../../math/probability-statistics/09-least-squares-method.html">最小二乗法</a></h5>
                  <p class="card-text">- 適当な関数(1次関数など)をモデル関数として、観測された結...</p>
                </div>
              </div>
            </div>
            
          </div>
        
          <div class="row flex-nowrap overflow-auto">
            <div class="col-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title fs-6"><a href="../../math/probability-statistics/08-regression.html">回帰</a></h5>
                  <p class="card-text">- 見えてるものの裏側に何があるのかを探る   - 見えるもの...</p>
                </div>
              </div>
            </div>
            
          </div>
        
          <div class="row flex-nowrap overflow-auto">
            <div class="col-4">
              <div class="card h-100">
                <div class="card-body">
                  <h5 class="card-title fs-6"><a href="../../math/probability-statistics/05a-variance.html">分散</a></h5>
                  <p class="card-text">- 標準偏差を2乗したもの - 分布Xの分散を $V[X]$ ...</p>
                </div>
              </div>
            </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/05-standared-deviation.html">標準偏差</a></h5>
                    <p class="card-text">- $S_x  \sqrt{\dfrac{\sum_{i=1}...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/28-binomial-dist.html">二項分布</a></h5>
                    <p class="card-text">- ベルヌーイ分布の確率分布を使う - $B_i(n,p)$ ...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/30-gaussian-dist.html">正規分布</a></h5>
                    <p class="card-text">- ガウス分布とも呼ばれる - ポワソン分布の確率 $p$ を...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/31-exponential-dist.html">指数分布</a></h5>
                    <p class="card-text">- $f(x)  \lambda \exp(- \lambda...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/23-.html">期待値を使った分散</a></h5>
                    <p class="card-text">- 分散を、平均の代わりに期待値を使って計算する - 離散型の...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/29-poisson-dist.html">ポワソン分布</a></h5>
                    <p class="card-text">- 二項分布 $Bi(n,p)$ の試行回数 $n$ を大きく...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/32-.html">記述統計</a></h5>
                    <p class="card-text">- あるデータの中で、平均はいくつか、分散はどれくらいか、のよ...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../math/probability-statistics/02-correlation-coefficien.html">相関係数</a></h5>
                    <p class="card-text">- 相関の度合いを測る係数   - 正なら正の相関   - 負...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../other/hirogari.html">広がり</a></h5>
                    <p class="card-text">- 物事が開けた、分散したようなさま - 一ヶ所に纏まってる、...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../scraps/sacrificial-architecture.html">犠牲的アーキテクチャ</a></h5>
                    <p class="card-text">- https://bliki-ja.github.io/Sa...</p>
                  </div>
                </div>
              </div>
            
              <div class="col-4">
                <div class="card h-100">
                  <div class="card-body">
                    <h5 class="card-title fs-6"><a href="../../simutrans/hida.html">飛騨</a></h5>
                    <p class="card-text">- AHNS-C2の飛騨付近の開発計画 - ニューヨークやシカ...</p>
                  </div>
                </div>
              </div>
            
          </div>
        
      </div>
      

    </article>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
    <script>
      document.addEventListener('DOMContentLoaded', (event) => {
        document.querySelectorAll('pre code').forEach((el) => {
          hljs.highlightElement(el);
        });
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.3.1/highlight.min.js"></script>
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']],
        },
        chtml: { 
          displayAlign: 'left',
        },
      };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
    </script>
  </body>
</html>
